= Information

== Правила синтаксиса (Валидность)

=== Основные правила синтаксиса XML:

1) Теги XML регистрозависимы — теги XML являются регистрозависимыми. Так, тег <Letter> не то же самое, что тег <letter>.
----
<Message>Это неправильно</message>
<message>Это правильно</message>
----

2) XML элементы должны соблюдать корректную вложенность:
----
<b><i>Некорректная вложенность</b></i>
<b><i>Корректная вложенность</i></b>
----

3) У XML документа должен быть корневой элемент — XML документ должен содержать один элемент, который будет родительским для всех других элементов. Он называется корневым элементом.
----
В большинстве XML файлов отчетов для ФНС корневым элементом является <Файл></Файл>. После закрывающего тега </Файл> больше ничего быть не должно.
----

4) Значения XML атрибутов должны заключаться в кавычки:
----
<note date="12/11/2007">Корректная запись</note>
<note date=12/11/2007>Некорреткная запись</note>
----

== Сущности

Некоторые символы в XML имеют особые значения и являются служебными. Если вы поместите, например, символ < внутри XML элемента, то будет сгенерирована ошибка, так как парсер интерпретирует его, как начало нового элемента.

Чтобы ошибки не возникали, нужно заменить символ < на его сущность. В XML существует 5 предопределенных сущностей:
[cols="2a,2a,5"]
|====
|Язык |Где используется |Значение

|
----
&lt;
----
|
----
<
----
|меньше, чем

|
----
&gt;
----
|
----
>
----
|больше, чем

|
----
&amp;
----
|
----
&
----
|амперсанд

|
----
&apos;
----
|
----
'
----
|апостроф

|
----
&quot;
----
|
----
"
----
|кавычки

|====

> Только символы < и & строго запрещены в XML. Символ > допустим, но лучше его всегда заменять на сущность.

Таким образом, корректными будут следующие формы записей:

----
<НПЮЛ ИННЮЛ="7718962261" КПП="771801001" НаимОрг="ООО&quot;Мосавтогруз&quot;"/>
----

или

----
<НПЮЛ ИННЮЛ="7718962261" КПП="771801001" НаимОрг="ООО«Мосавтогруз»"/>
----

В последнем примере английские двойные кавычки заменены на французские кавычки («ёлочки»), которые не являются служебными символами.


== Поиск информации в XML файлах (XPath)

Это очень похоже на организацию каталогов в файловой системе, и строки XPath, фактически, — пути к «файлам» — элементам. Рассмотрим пример списка книг:

[source,xml]
----
<?xml version="1.0" encoding="windows-1251"?>
<bookstore>
   <book category="COOKING">
     <title lang="it">Everyday Italian</title>
     <author>Giada De Laurentiis</author>
     <year>2005</year>
     <price>30.00</price>
   </book>
   <book category="CHILDREN">
     <title lang="en">Harry Potter</title>
     <author>J K. Rowling</author>
     <year>2005</year>
     <price>29.99</price>
   </book>
   <book category="WEB">
     <title lang="en">Learning XML</title>
     <author>Erik T. Ray</author>
     <year>2003</year>
     <price>39.95</price>
   </book>
</bookstore>
----

XPath запрос /bookstore/book/price вернет следующий результат:

----
<price>30.00</price>
<price>29.99</price>
<price>39.95</price>
----

Сокращенная форма этого запроса выглядит так: pass:[<kbd>//price</kbd>].

С помощью XPath запросов можно искать информацию по атрибутам. Например, можно найти информацию о книге на итальянском языке: pass:[<kbd>//title[@lang="it"&#93;</kbd>]
вернет
[source,xml]
----
<title lang="it">Everyday Italian</title>.
----
Чтобы получить больше информации, необходимо модифицировать запрос pass:[<kbd>//book[title[@lang="it"&#93;&#93;</kbd>] вернет:
[source,xml]
----
<book category="COOKING">
<title lang="it">Everyday Italian</title>
<author>Giada De Laurentiis</author>
<year>2005</year>
<price>30.00</price>
</book>
----

В приведенной ниже таблице представлены некоторые выражения XPath и результат их работы:

[cols="2a,2a"]
|====
|Выражение XPath	|Результат

|
----
/bookstore/book[1]
----
|Выбирает первый элемент ``book``, который является потомком элемента ``bookstore``
|
----
/bookstore/book[position()<3]
----
|Выбирает первые два элемента ``book``, которые являются потомками элемента ``bookstore``
|
----
//title[@lang]
----
|Выбирает все элементы ``title`` с атрибутом ``lang``

|
----
//title[@lang=’en’]
----
|Выбирает все элементы ``title`` с атрибутом ``lang``, который имеет значение ``en``


|
----
/bookstore/book[price>35.00]
----
|Выбирает первый элемент ``book``, который является потомком элемента ``bookstore``

|
----
/bookstore/book[price>35.00]/title
----
|Выбирает все элементы ``title`` элементов ``book`` элементов ``bookstore``, которые содержать элемент ``price`` со значением больше ``35.00``
|====

== XSD схема

XML Schema — язык описания структуры XML-документа, его также называют XSD. Как большинство языков описания XML, XML Schema была задумана для определения правил, которым должен подчиняться документ. Но, в отличие от других языков, XML Schema была разработана так, чтобы её можно было использовать в создании программного обеспечения для обработки документов XML.

После проверки документа на соответствие XML Schema читающая программа может создать модель данных документа, которая включает:

* словарь (названия элементов и атрибутов);
* модель содержания (отношения между элементами и атрибутами и их структура);
* типы данных.

Каждый элемент в этой модели ассоциируется с определённым типом данных, позволяя строить в памяти объект, соответствующий структуре XML-документа. Языкам объектно-ориентированного программирования гораздо легче иметь дело с таким объектом, чем с текстовым файлом.